
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Working with rasters &#8212; SARP Programming Lessons</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'additional_lectures/rasters/2_raster_fundamentals';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Accessing Data" href="3_accessing_coordinates.html" />
    <link rel="prev" title="Arrays and numpy" href="1_arrays_numpy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sarp_logo.png" class="logo__image only-light" alt="SARP Programming Lessons - Home"/>
    <img src="../../_static/sarp_logo.png" class="logo__image only-dark pst-js-only" alt="SARP Programming Lessons - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Welcome to SARP Programming
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Python Progression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sarp_lessons/1_python_progression/1-general_python/index.html">1. Python Building Blocks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/1-general_python/1-1_variables_types_ifstatements.html">1.1 Variables, Data Types, and if Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/1-general_python/1-2_lists_dictionaries.html">1.2 Lists and Dictionaries</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sarp_lessons/1_python_progression/2-tabular_data/index.html">2. Tabular Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/2-tabular_data/2-1_pandas.html">2.1 The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/2-tabular_data/2-2_filtering_groupby.html">2.2 Filtering and groupby</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sarp_lessons/1_python_progression/3-gridded_data/index.html">3. Gridded Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/3-gridded_data/3-1_xarray.html">3.1 The <code class="docutils literal notranslate"><span class="pre">xarray</span></code> Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/3-gridded_data/3-2_xarray_computation.html">3.2 Starting Computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/3-gridded_data/3-3_xarray_groupby.html">3.3 <code class="docutils literal notranslate"><span class="pre">xarray</span></code> Groupby</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sarp_lessons/1_python_progression/4-spatiotemporal/index.html">4. Spatio-temporal Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/4-spatiotemporal/4-1_datetimes.html">4.1 Datetimes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/4-spatiotemporal/4-2_spatial_data.html">4.2 Spatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/4-spatiotemporal/4-3_geopandas.html">4.3 <code class="docutils literal notranslate"><span class="pre">geopandas</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/4-spatiotemporal/4-4_spatial_operations_rio.html">4.4 Spatial Operations and <code class="docutils literal notranslate"><span class="pre">rio</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sarp_lessons/1_python_progression/4-spatiotemporal/4-5_mapping_cartopy.html">4.5 Mapping with <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> and Colors</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Skills</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Debugging/debugging_lesson.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time_series_statistics/oceans_stats_examples.html">Time Series Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hierarchical_data/hierarchical_data.html">Hierarchical Data Structure</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Raster Data Lessons</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_arrays_numpy.html">Arrays and <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Working with rasters</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_accessing_coordinates.html">Accessing Data</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice Problems &amp; Answers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../index_practice.html">Raster Data Practice (Additional Lectures)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="practice/1_arrays_numpy_practice.html">Arrays and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> Practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="practice/2_raster_fundamentals_practice.html">Raster Fundamentals Practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="practice/3_accessing_coordinates_practice.html">Accessing Coordinates Practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="practice/1_arrays_numpy_answers.html">Arrays and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> Answers</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Example Gallery</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html">Visualization Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/logplot.html">Plot with multiple lines and a log axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/flight_track.html">Flight Track Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/altitude_twin_axes.html">Altitude Plot with Twin Axes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/gridded_mapping.html">Cartopy with gridded data</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributor Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/env_setup.html">Contributing to SARP Lessons</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/rwegener2/sarp_lessons" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rwegener2/sarp_lessons/issues/new?title=Issue%20on%20page%20%2Fadditional_lectures/rasters/2_raster_fundamentals.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/additional_lectures/rasters/2_raster_fundamentals.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working with rasters</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-anatomy-of-a-raster">🧠 The Anatomy of a raster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-a-file">📖 Opening a file</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-a-file-with-rasterio">Opening a file with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filepaths">Filepaths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-raster-band-with-rasterio">Reading a raster band with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-a-quick-visual-of-the-data">Getting a quick visual of the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-the-metadata">🔍 Inspecting the Metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-the-data">🚜 Working with the Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing">Indexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-statistics">Exploratory statistics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-operations">Matrix Operations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting">Plotting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-a-file">💾 Saving a file</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-rasters">
<h1>Working with rasters<a class="headerlink" href="#working-with-rasters" title="Link to this heading">#</a></h1>
<div class="note dropdown admonition">
<p class="admonition-title">Lesson Content</p>
<ul class="simple">
<li><p>🧠Anatomy of a raster</p></li>
<li><p>📖Opening a file</p></li>
<li><p>🔍Inspecting the metadata</p></li>
<li><p>🚜Working with the data</p></li>
<li><p>💾Saving a file</p></li>
</ul>
</div>
<section id="the-anatomy-of-a-raster">
<h2>🧠 The Anatomy of a raster<a class="headerlink" href="#the-anatomy-of-a-raster" title="Link to this heading">#</a></h2>
<p>Working with raster data involves understanding how rasters are organized.</p>
<p><img alt="Raster Anatomy" src="../../_images/raster_anatomy.jpg" /></p>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>You open a raster file and see that the count is 224.  What have you just learned about the raster?</p>
</div>
</section>
<section id="opening-a-file">
<h2>📖 Opening a file<a class="headerlink" href="#opening-a-file" title="Link to this heading">#</a></h2>
<p>When you open data files in Python you usually need to use a library.  When dealing with raster data there are several common libraries, most of which cater to a specific data type:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>File Format</p></th>
<th class="head"><p>File Extension</p></th>
<th class="head"><p>Python Library</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>netCDF</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.nc</span></code></p></td>
<td><p>netCDF4</p></td>
</tr>
<tr class="row-odd"><td><p>HDF5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.hdf5</span></code></p></td>
<td><p>h5py</p></td>
</tr>
<tr class="row-even"><td><p>HDF4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.hdf4</span></code></p></td>
<td><p>pyhdf</p></td>
</tr>
<tr class="row-odd"><td><p>geoTIFF</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.tiff</span></code></p></td>
<td><p>rasterio</p></td>
</tr>
<tr class="row-even"><td><p>zarr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.zarr</span></code></p></td>
<td><p>zarr</p></td>
</tr>
</tbody>
</table>
</div>
<p>While each of these libraries works best with their associated file type, I really like to use <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> because it does a particularly good job of accomodating <a class="reference external" href="https://gdal.org/drivers/raster/index.html">many data types</a>.  I usually start with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> and switch to the a different file-specific library only if I need something extra <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> doesn’t already provide.</p>
<section id="opening-a-file-with-rasterio">
<h3>Opening a file with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code><a class="headerlink" href="#opening-a-file-with-rasterio" title="Link to this heading">#</a></h3>
<p>We open our rasters with the <code class="docutils literal notranslate"><span class="pre">rasterio.open()</span></code> method.  The general syntax is</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">FILEPATH_TO_RASTER</span><span class="p">,</span> <span class="n">DATAMODE</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">FILEPATH_TO_RASTER</span></code> is the place on your computer where the data is stored and <code class="docutils literal notranslate"><span class="pre">DATAMODE</span></code> is usually either ‘r’ for read (opening existing data) or ‘w’ for write (creating new data).  There are other data modes but these are two very common ones.</p>
<p>An example of opening a file using test AVIRIS data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the filepath to our raster</span>
<span class="n">filepath_rad</span> <span class="o">=</span> <span class="s1">&#39;./data/subset_f180628t01p00r02_corr_v1k1_img&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="filepaths">
<h3>Filepaths<a class="headerlink" href="#filepaths" title="Link to this heading">#</a></h3>
<p>Ahe <strong>filepath</strong> and is a string that describes the location of the data that you want to open.  A few pieces of the anatomy of a filepath to notice:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> - forward slashes signal that you have entered a new folder.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.</span></code> - the period at the beginning tells the computer to start looking for data in the same place tht the code is being run in.</p></li>
</ul>
<p>Choosing to start your filepath with a <code class="docutils literal notranslate"><span class="pre">.</span></code> is called specificying a <strong>relative filepath</strong>, because you are telling the computer to start looking for the file relative to where the file is being run. If you move this file to another place on your computer and don’t move the data with it the import statment won’t work anymore.  The alternative to a relative filepath is an <strong>aboslute filepath</strong>, in which case you start your file path at the very tippy top of your computer’s organizational structure (the root directory).</p>
<p>Other vocab notes:</p>
<ul class="simple">
<li><p><strong>directory</strong> is the same thing as a folder.</p></li>
</ul>
<p>To loop back to our example, we put together our filepath by defining the following directions for our computer:</p>
<ol class="arabic simple">
<li><p>start by specifing the current directory as the starting point: <code class="docutils literal notranslate"><span class="pre">.</span></code></p></li>
<li><p>go into the data folder: <code class="docutils literal notranslate"><span class="pre">./data</span></code></p></li>
<li><p>choose the file named “subset_f180628t01p00r02_corr_v1k1_img”:
<code class="docutils literal notranslate"><span class="pre">'./data/subset_f180628t01p00r02_corr_v1k1_img'</span></code></p></li>
</ol>
<p>🎉 And there we have our file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rasterio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">rasterio</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;rasterio&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open the file</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The object that gets returned here <code class="docutils literal notranslate"><span class="pre">&lt;open</span> <span class="pre">DatasetReader</span> <span class="pre">name='./data/subset_f180628t01p00r02_corr_v1k1_img'</span> <span class="pre">mode='r'&gt;</span></code> is the “Dataset Reader” object.  This object connects you to the file in Python, but it isn’t actually the data.  To get to the data you need to use <code class="docutils literal notranslate"><span class="pre">src.read()</span></code>.</p>
</section>
<section id="reading-a-raster-band-with-rasterio">
<h3>Reading a raster band with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code><a class="headerlink" href="#reading-a-raster-band-with-rasterio" title="Link to this heading">#</a></h3>
<p>General syntax:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">FILEPATH_TO_RASTER</span><span class="p">,</span> <span class="n">DATAMODE</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BAND_INDEX</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">FILEPATH_TO_RASTER</span></code> is the place on your computer where the data is <code class="docutils literal notranslate"><span class="pre">DATAMODE</span></code> is usually either ‘r’ for read (opening existing data) or ‘w’ for write (creating new data).  <code class="docutils literal notranslate"><span class="pre">BAND_INDEX</span></code> indicates which band you want to read.  Leaving <code class="docutils literal notranslate"><span class="pre">BAND_INDEX</span></code> blank reads the entire raster (all bands).</p>
<p>An example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading the first band from our file</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>What gets printed here are our actual data values! 🎉</p>
</section>
<section id="getting-a-quick-visual-of-the-data">
<h3>Getting a quick visual of the data<a class="headerlink" href="#getting-a-quick-visual-of-the-data" title="Link to this heading">#</a></h3>
<p>Another way to quickly get eyes on our data is to use the <code class="docutils literal notranslate"><span class="pre">show</span></code> command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>The plot and the array might not be very useful right now, but at least we have validated that we can open our raster and that it contains data.</p>
<p>If you like viewing quick plots as a way of interacting with your data you can read more about it in the <a class="reference external" href="https://rasterio.readthedocs.io/en/latest/topics/plotting.html">rasterio docs</a>.</p>
<div class="note dropdown admonition">
<p class="admonition-title">🌀 More Info: Context managers</p>
<p>It might be new to you that I used the syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="o">...</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>This syntax is called the <strong>Context manager</strong>.  When we read files we are opening them up, like a book, and they stay open until we tell the program to close them.  The benefit of the context manager is that it opens up a file when you use the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement, runs all your lines of indented code, and the closes the file after.  This is important if you are opening up large files.  Your computer only has so much memory, so if you try to open too many 8GB files at once without closing them you can crash your program.</p>
<p>If you don’t want to use the contect manager another way to this same task is to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>If you do this, though, make sure to only be working with a few files at a time or to close your files.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>What is happening in the following piece of code?  How many bands will be affected?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/f180628t01p00r02_corr_v1k1_img&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="inspecting-the-metadata">
<h2>🔍 Inspecting the Metadata<a class="headerlink" href="#inspecting-the-metadata" title="Link to this heading">#</a></h2>
<p>When you first open a dataset it is often helpful to get your bearings by inspecting the metadata.  In rasterio we do this by inspecting the DatasetReader object (<code class="docutils literal notranslate"><span class="pre">src</span></code>) that was returned when you opened the object.</p>
<p>There are <a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#rasterio._base.DatasetBase">lots of attributes</a> that you check a dataset reader for.  If you want to get an general overview I like to use <code class="docutils literal notranslate"><span class="pre">src.meta</span></code>.  To extract specific values here are some more attributes that I find useful:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id1"><code class="docutils literal notranslate"><span class="pre">src.bounds</span></code></a> - Returns the lower left and upper right bounds of the dataset in the units of its coordinate reference system. (lower left x, lower left y, upper right x, upper right y)</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id5"><code class="docutils literal notranslate"><span class="pre">src.count</span></code></a> - The number of raster bands in the dataset</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id6"><code class="docutils literal notranslate"><span class="pre">src.crs</span></code></a> - The dataset’s coordinate reference system</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id7"><code class="docutils literal notranslate"><span class="pre">src.descriptions</span></code></a> - Descriptions for each dataset band</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#rasterio._base.DatasetBase.dtypes"><code class="docutils literal notranslate"><span class="pre">src.dtypes</span></code></a> - The data types of each band in index order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src.height</span></code> - The number of pixels in each column</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id11"><code class="docutils literal notranslate"><span class="pre">src.indexes</span></code></a> - The 1-based indexes of each band in the dataset</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id14"><code class="docutils literal notranslate"><span class="pre">src.meta</span></code></a> - The basic metadata of this dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src.name</span></code> - Relative filepath of the dataset</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id17"><code class="docutils literal notranslate"><span class="pre">src.nodata</span></code></a> - The dataset’s single nodata value</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id22"><code class="docutils literal notranslate"><span class="pre">src.res</span></code></a> - Returns the (width, height) of pixels in the units of its coordinate reference system.</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id24"><code class="docutils literal notranslate"><span class="pre">src.transform</span></code></a> - The dataset’s georeferencing transformation matrix</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id25"><code class="docutils literal notranslate"><span class="pre">src.units</span></code></a> - one units string for each dataset band</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src.width</span></code> - the number of pixels in each row</p></li>
</ul>
<p>All of the parts of the raster that were addressed in the first section of this notebook  <em>Anatomy of a raster</em> are accessible using these attributes.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try substituting any of the above attributes in for this dataset</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With the above print statement we learned from the <code class="docutils literal notranslate"><span class="pre">src.meta</span></code> information that the raster has 224 bands (<code class="docutils literal notranslate"><span class="pre">count</span></code>) it has the coordinate reference system EPSG code 32610 (<code class="docutils literal notranslate"><span class="pre">crs</span></code>), it is an ENVI filetype (<code class="docutils literal notranslate"><span class="pre">driver</span></code>), the datatype is float32 (<code class="docutils literal notranslate"><span class="pre">dtype</span></code>), it has 250 rows or is 250 pixels tall (<code class="docutils literal notranslate"><span class="pre">height</span></code>), there isn’t a nodata value set (<code class="docutils literal notranslate"><span class="pre">nodata</span></code>), the affine tranform is (1.02258007728804e-15, 16.7, 769855.79, 16.7, -1.02258007728804e-15, 3751257.6) (<code class="docutils literal notranslate"><span class="pre">tranform</span></code>), and that the raster has 375 columns or is 375 pixels wide.  We also see the relative filepath of the raster from the <code class="docutils literal notranslate"><span class="pre">src.name</span></code> attribute.</p>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>Which of the following are metadata in an AVIRIS reflectance dataset?</p>
<ul class="simple">
<li><p>A) Number of bands</p></li>
<li><p>B) Coordinate information</p></li>
<li><p>C) Reflectance values</p></li>
<li><p>D) Height/Lines and Width/Samples</p></li>
</ul>
<p>Answer with all of the letters that are metadata.</p>
</div>
</section>
</section>
<section id="working-with-the-data">
<h2>🚜 Working with the Data<a class="headerlink" href="#working-with-the-data" title="Link to this heading">#</a></h2>
<p>While the raster file is is accessed through a unique filetype-specific library, the actual data is almost always just a common matrix datatype.  Numpy is the most common library used, but xarray is also used by some data libraries.</p>
<p>This means that everything we working on last week for matricies applies to the data inside the raster file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">red_band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">blue_band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">green_band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="indexing">
<h3>Indexing<a class="headerlink" href="#indexing" title="Link to this heading">#</a></h3>
<p>A reminder about matrix indexing:</p>
<ul class="simple">
<li><p>2D matrices use row, column order</p></li>
<li><p>3D matrices use height, row, column order</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span><span class="p">[</span><span class="mi">249</span><span class="p">,</span> <span class="mi">374</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span><span class="p">[</span><span class="mi">144</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># One long row of data</span>
<span class="n">red_band</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploratory-statistics">
<h3>Exploratory statistics<a class="headerlink" href="#exploratory-statistics" title="Link to this heading">#</a></h3>
<p>When I open a dataset I often like to get a sense of it by just looking at looking at statistics for one of the bands.  We can use the aggregation functions from last week for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max value: &#39;</span><span class="p">,</span> <span class="n">green_band</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean value: &#39;</span><span class="p">,</span> <span class="n">green_band</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;min value: &#39;</span><span class="p">,</span> <span class="n">green_band</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrix-operations">
<h3>Matrix Operations<a class="headerlink" href="#matrix-operations" title="Link to this heading">#</a></h3>
<p>Adding and subtracting two matrices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span> <span class="o">+</span> <span class="n">green_band</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blue_band</span> <span class="o">-</span> <span class="n">red_band</span>
</pre></div>
</div>
</div>
</div>
<p>Multiplying or dividing a matrix by a constant</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span><span class="o">*</span><span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">green_band</span><span class="o">/</span><span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<p>Some other built in operations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We have to take the absolute value of red because the nodata values are negative </span>
<span class="c1"># and that throws an error</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">red_band</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">red_band</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>There are lots more built in functions.  <a class="reference external" href="https://www.oreilly.com/library/view/python-for-data/9781449323592/ch04.html#table_unary_ufuncs">This table</a> has a nice list.</p>
</section>
<section id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Link to this heading">#</a></h3>
<p>Also notice that plotting works for a single band</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">red_band</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>Say that the variable <code class="docutils literal notranslate"><span class="pre">reflectance</span></code> hold all of the data for an AVIRIS raster – count 224 with 1000 rows and 350 columns.</p>
<p>What is the index you need to use to get the all the data for band 100?</p>
</div>
</section>
</section>
<section id="saving-a-file">
<h2>💾 Saving a file<a class="headerlink" href="#saving-a-file" title="Link to this heading">#</a></h2>
<p>At a certain point you may want to do it.  Let’s start by getting some data to save</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get our data setup</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">red_src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">blue_src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">green_src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>It is best practice to persist or update as much of the metadata from your old raster as you can.  As you may have experienced working with data, complete and accurate metadata can make someone else’s life (and maybe even your own) much easier down the road.  Make sure you look at it, though, to make sure all the information still applies to your new raster.</p>
<p>Count has changed, since we are only saving 3 of the 224 total bands, so we need to upadate the <code class="docutils literal notranslate"><span class="pre">count</span></code> value.  I am also going to set -50 as the nodata value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<p>Another thing you could do is add tags to your bands so that you remember what band number you used.  You do this when you write out the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the output directory if it does not exist yet</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;../output_data&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;../output_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
    <span class="s1">&#39;../output_data/rgb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;w&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">meta</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="c1"># Write data matrices</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">red_src</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">green_src</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">blue_src</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1"># Add band tags</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">src_band</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">src_band</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">src_band</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we want to confirm that our dataset saved properly we can open it back up and look at what we saved.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../output_data/rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">red_dst</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">green_dst</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">blue_dst</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Source stats: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;red: &#39;</span><span class="p">,</span> <span class="n">red_src</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">red_src</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;green: &#39;</span><span class="p">,</span> <span class="n">green_src</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">green_src</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blue: &#39;</span><span class="p">,</span> <span class="n">blue_src</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">blue_src</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Destination stats: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;red: &#39;</span><span class="p">,</span> <span class="n">red_dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">red_dst</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;green: &#39;</span><span class="p">,</span> <span class="n">green_dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">green_dst</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blue: &#39;</span><span class="p">,</span> <span class="n">blue_dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">blue_dst</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Our values line up!  And the new values came from the raster we made ourselves.  😄</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./additional_lectures/rasters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1_arrays_numpy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Arrays and <code class="docutils literal notranslate"><span class="pre">numpy</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="3_accessing_coordinates.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Accessing Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-anatomy-of-a-raster">🧠 The Anatomy of a raster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-a-file">📖 Opening a file</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-a-file-with-rasterio">Opening a file with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filepaths">Filepaths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-raster-band-with-rasterio">Reading a raster band with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-a-quick-visual-of-the-data">Getting a quick visual of the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-the-metadata">🔍 Inspecting the Metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-the-data">🚜 Working with the Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing">Indexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-statistics">Exploratory statistics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-operations">Matrix Operations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting">Plotting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-a-file">💾 Saving a file</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Rachel Wegener
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>