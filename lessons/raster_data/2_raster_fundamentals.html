
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Working with rasters &#8212; SARP Programming Lessons</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Accessing Data" href="3_accessing_coordinates.html" />
    <link rel="prev" title="Arrays and numpy" href="1_arrays_numpy.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/sarp_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SARP Programming Lessons</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   Welcome to the SARP Programming Website
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lessons
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../general_python/index.html">
   General Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/1_variables_types_ifstatements.html">
     Variables, Data types, and if Statements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/2_lists_dictionaries.html">
     Lists and Dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/datetimes.html">
     Datetimes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/spatial_data.html">
     Spatial Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Raster Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="1_arrays_numpy.html">
     Arrays and
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Working with rasters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_accessing_coordinates.html">
     Accessing Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tabular_data/index.html">
   Tabular Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/1_pandas.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/2_filtering_groupby.html">
     Filtering and groupby
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/3_geopandas.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       geopandas
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Additional Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../additional_lectures/debugging/debugging_lesson.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../additional_lectures/time_series_statistics/oceans_stats_examples.html">
   Time Series Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../additional_lectures/hierarchical_data/hierarchical_data.html">
   Hierarchical Data Structure
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../additional_lectures/visualization/index.html">
   Visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../additional_lectures/visualization/1_static_viz_with_matplotlib.html">
     Static Data Visualization in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../additional_lectures/visualization/2_building_on_matplotlib.html">
     Building on top of
     <code class="docutils literal notranslate">
      <span class="pre">
       matplotlib
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../additional_lectures/visualization/3_dynamic_visualization.html">
     Dynamic Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../additional_lectures/visualization/viewing_images.html">
     Viewing Images
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Practice Sheets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../index_practice.html">
   General Python Practice
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/1_variables_data_practice.html">
     Variables, Data Types and If statements Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/2_lists_dicts_practice.html">
     Lists and Dictionaries Answers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/datetimes_practice.html">
     Datetimes Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/spatial_data_practice.html">
     Spatial Data Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/1_variables_data_answers.html">
     Variables, Data Types and If statements Answers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/2_lists_dicts_answers.html">
     Lists and Dictionaries Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/datetimes_answers.html">
     Datetimes Answers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general_python/practice/spatial_data_answers.html">
     Spatial Data Answers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../index_practice_raster.html">
   Raster Data Practice
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="practice/1_arrays_numpy_practice.html">
     Arrays and
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
     Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="practice/2_raster_fundamentals_practice.html">
     Raster Fundamentals Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="practice/3_accessing_coordinates_practice.html">
     Accessing Coordinates Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="practice/1_arrays_numpy_answers.html">
     Arrays and
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
     Answers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../index_practice_tabular.html">
   Tabular Data Practice
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/practice/1_pandas_practice.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/practice/2_filtering_groupby_practice.html">
     Filtering and Groupby Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/practice/3_geopandas_practice.html">
     Practice with
     <code class="docutils literal notranslate">
      <span class="pre">
       geopandas
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/practice/1_pandas_answers.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     Answers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular_data/practice/2_filtering_groupby_answers.html">
     Filtering and Groupby Answers
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lessons/raster_data/2_raster_fundamentals.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rwegener2/sarp_lessons"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rwegener2/sarp_lessons/issues/new?title=Issue%20on%20page%20%2Flessons/raster_data/2_raster_fundamentals.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rwegener2/sarp_lessons/main?urlpath=tree/lessons/raster_data/2_raster_fundamentals.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-anatomy-of-a-raster">
   🧠 The Anatomy of a raster
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#opening-a-file">
   📖 Opening a file
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#opening-a-file-with-rasterio">
     Opening a file with
     <code class="docutils literal notranslate">
      <span class="pre">
       rasterio
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filepaths">
     Filepaths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-a-raster-band-with-rasterio">
     Reading a raster band with
     <code class="docutils literal notranslate">
      <span class="pre">
       rasterio
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-a-quick-visual-of-the-data">
     Getting a quick visual of the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inspecting-the-metadata">
   🔍 Inspecting the Metadata
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-the-data">
   🚜 Working with the Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indexing">
     Indexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploratory-statistics">
     Exploratory statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-operations">
     Matrix Operations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-a-file">
   💾 Saving a file
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Working with rasters</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-anatomy-of-a-raster">
   🧠 The Anatomy of a raster
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#opening-a-file">
   📖 Opening a file
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#opening-a-file-with-rasterio">
     Opening a file with
     <code class="docutils literal notranslate">
      <span class="pre">
       rasterio
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filepaths">
     Filepaths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-a-raster-band-with-rasterio">
     Reading a raster band with
     <code class="docutils literal notranslate">
      <span class="pre">
       rasterio
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-a-quick-visual-of-the-data">
     Getting a quick visual of the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inspecting-the-metadata">
   🔍 Inspecting the Metadata
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-the-data">
   🚜 Working with the Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indexing">
     Indexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploratory-statistics">
     Exploratory statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-operations">
     Matrix Operations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-a-file">
   💾 Saving a file
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="working-with-rasters">
<h1>Working with rasters<a class="headerlink" href="#working-with-rasters" title="Permalink to this headline">¶</a></h1>
<div class="note dropdown admonition">
<p class="admonition-title">Lesson Content</p>
<ul class="simple">
<li><p>🧠Anatomy of a raster</p></li>
<li><p>📖Opening a file</p></li>
<li><p>🔍Inspecting the metadata</p></li>
<li><p>🚜Working with the data</p></li>
<li><p>💾Saving a file</p></li>
</ul>
</div>
<div class="section" id="the-anatomy-of-a-raster">
<h2>🧠 The Anatomy of a raster<a class="headerlink" href="#the-anatomy-of-a-raster" title="Permalink to this headline">¶</a></h2>
<p>Working with raster data involves understanding how rasters are organized.</p>
<p><img alt="Raster Anatomy" src="../../_images/raster_anatomy.jpg" /></p>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>You open a raster file and see that the count is 224.  What have you just learned about the raster?</p>
</div>
</div>
<div class="section" id="opening-a-file">
<h2>📖 Opening a file<a class="headerlink" href="#opening-a-file" title="Permalink to this headline">¶</a></h2>
<p>When you open data files in Python you usually need to use a library.  When dealing with raster data there are several common libraries, most of which cater to a specific data type:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>File Format</p></th>
<th class="head"><p>File Extension</p></th>
<th class="head"><p>Python Library</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>netCDF</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.nc</span></code></p></td>
<td><p>netCDF4</p></td>
</tr>
<tr class="row-odd"><td><p>HDF5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.hdf5</span></code></p></td>
<td><p>h5py</p></td>
</tr>
<tr class="row-even"><td><p>HDF4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.hdf4</span></code></p></td>
<td><p>pyhdf</p></td>
</tr>
<tr class="row-odd"><td><p>geoTIFF</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.tiff</span></code></p></td>
<td><p>rasterio</p></td>
</tr>
<tr class="row-even"><td><p>zarr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.zarr</span></code></p></td>
<td><p>zarr</p></td>
</tr>
</tbody>
</table>
<p>While each of these libraries works best with their associated file type, I really like to use <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> because it does a particularly good job of accomodating <a class="reference external" href="https://gdal.org/drivers/raster/index.html">many data types</a>.  I usually start with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> and switch to the a different file-specific library only if I need something extra <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> doesn’t already provide.</p>
<div class="section" id="opening-a-file-with-rasterio">
<h3>Opening a file with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code><a class="headerlink" href="#opening-a-file-with-rasterio" title="Permalink to this headline">¶</a></h3>
<p>We open our rasters with the <code class="docutils literal notranslate"><span class="pre">rasterio.open()</span></code> method.  The general syntax is</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">FILEPATH_TO_RASTER</span><span class="p">,</span> <span class="n">DATAMODE</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">FILEPATH_TO_RASTER</span></code> is the place on your computer where the data is stored and <code class="docutils literal notranslate"><span class="pre">DATAMODE</span></code> is usually either ‘r’ for read (opening existing data) or ‘w’ for write (creating new data).  There are other data modes but these are two very common ones.</p>
<p>An example of opening a file using test AVIRIS data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the filepath to our raster</span>
<span class="n">filepath_rad</span> <span class="o">=</span> <span class="s1">&#39;./data/subset_f180628t01p00r02_corr_v1k1_img&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="filepaths">
<h3>Filepaths<a class="headerlink" href="#filepaths" title="Permalink to this headline">¶</a></h3>
<p>Ahe <strong>filepath</strong> and is a string that describes the location of the data that you want to open.  A few pieces of the anatomy of a filepath to notice:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> - forward slashes signal that you have entered a new folder.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.</span></code> - the period at the beginning tells the computer to start looking for data in the same place tht the code is being run in.</p></li>
</ul>
<p>Choosing to start your filepath with a <code class="docutils literal notranslate"><span class="pre">.</span></code> is called specificying a <strong>relative filepath</strong>, because you are telling the computer to start looking for the file relative to where the file is being run. If you move this file to another place on your computer and don’t move the data with it the import statment won’t work anymore.  The alternative to a relative filepath is an <strong>aboslute filepath</strong>, in which case you start your file path at the very tippy top of your computer’s organizational structure (the root directory).</p>
<p>Other vocab notes:</p>
<ul class="simple">
<li><p><strong>directory</strong> is the same thing as a folder.</p></li>
</ul>
<p>To loop back to our example, we put together our filepath by defining the following directions for our computer:</p>
<ol class="simple">
<li><p>start by specifing the current directory as the starting point: <code class="docutils literal notranslate"><span class="pre">.</span></code></p></li>
<li><p>go into the data folder: <code class="docutils literal notranslate"><span class="pre">./data</span></code></p></li>
<li><p>choose the file named “subset_f180628t01p00r02_corr_v1k1_img”:
<code class="docutils literal notranslate"><span class="pre">'./data/subset_f180628t01p00r02_corr_v1k1_img'</span></code></p></li>
</ol>
<p>🎉 And there we have our file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rasterio</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open the file</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;open DatasetReader name=&#39;./data/subset_f180628t01p00r02_corr_v1k1_img&#39; mode=&#39;r&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The object that gets returned here <code class="docutils literal notranslate"><span class="pre">&lt;open</span> <span class="pre">DatasetReader</span> <span class="pre">name='./data/subset_f180628t01p00r02_corr_v1k1_img'</span> <span class="pre">mode='r'&gt;</span></code> is the “Dataset Reader” object.  This object connects you to the file in Python, but it isn’t actually the data.  To get to the data you need to use <code class="docutils literal notranslate"><span class="pre">src.read()</span></code>.</p>
</div>
<div class="section" id="reading-a-raster-band-with-rasterio">
<h3>Reading a raster band with <code class="docutils literal notranslate"><span class="pre">rasterio</span></code><a class="headerlink" href="#reading-a-raster-band-with-rasterio" title="Permalink to this headline">¶</a></h3>
<p>General syntax:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">FILEPATH_TO_RASTER</span><span class="p">,</span> <span class="n">DATAMODE</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BAND_INDEX</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">FILEPATH_TO_RASTER</span></code> is the place on your computer where the data is <code class="docutils literal notranslate"><span class="pre">DATAMODE</span></code> is usually either ‘r’ for read (opening existing data) or ‘w’ for write (creating new data).  <code class="docutils literal notranslate"><span class="pre">BAND_INDEX</span></code> indicates which band you want to read.  Leaving <code class="docutils literal notranslate"><span class="pre">BAND_INDEX</span></code> blank reads the entire raster (all bands).</p>
<p>An example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading the first band from our file</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-8.8028395e-01 -8.8028395e-01 -8.8028395e-01 ...  7.7182706e-04
   1.8142069e-02  2.4249963e-02]
 [-8.8028395e-01 -8.8028395e-01 -8.8028395e-01 ...  1.2664238e-02
   1.7274955e-02  2.1294061e-02]
 [-8.8028395e-01 -8.8028395e-01 -8.8028395e-01 ...  1.6278537e-02
   1.4166061e-02  1.2966915e-02]
 ...
 [-8.8028395e-01 -8.8028395e-01 -8.8028395e-01 ...  3.9758585e-02
   3.6750916e-02  4.9293626e-02]
 [-8.8028395e-01 -8.8028395e-01 -8.8028395e-01 ...  4.6895660e-02
   5.5631310e-02  4.7900975e-02]
 [-8.8028395e-01 -8.8028395e-01 -8.8028395e-01 ...  5.4747202e-02
   5.0485637e-02  5.1755313e-02]]
</pre></div>
</div>
</div>
</div>
<p>What gets printed here are our actual data values! 🎉</p>
</div>
<div class="section" id="getting-a-quick-visual-of-the-data">
<h3>Getting a quick visual of the data<a class="headerlink" href="#getting-a-quick-visual-of-the-data" title="Permalink to this headline">¶</a></h3>
<p>Another way to quickly get eyes on our data is to use the <code class="docutils literal notranslate"><span class="pre">show</span></code> command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2_raster_fundamentals_25_0.png" src="../../_images/2_raster_fundamentals_25_0.png" />
</div>
</div>
<p>The plot and the array might not be very useful right now, but at least we have validated that we can open our raster and that it contains data.</p>
<p>If you like viewing quick plots as a way of interacting with your data you can read more about it in the <a class="reference external" href="https://rasterio.readthedocs.io/en/latest/topics/plotting.html">rasterio docs</a>.</p>
<div class="note dropdown admonition">
<p class="admonition-title">🌀 More Info: Context managers</p>
<p>It might be new to you that I used the syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="o">...</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>This syntax is called the <strong>Context manager</strong>.  When we read files we are opening them up, like a book, and they stay open until we tell the program to close them.  The benefit of the context manager is that it opens up a file when you use the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement, runs all your lines of indented code, and the closes the file after.  This is important if you are opening up large files.  Your computer only has so much memory, so if you try to open too many 8GB files at once without closing them you can crash your program.</p>
<p>If you don’t want to use the contect manager another way to this same task is to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="n">src</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>If you do this, though, make sure to only be working with a few files at a time or to close your files.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>What is happening in the following piece of code?  How many bands will be affected?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/f180628t01p00r02_corr_v1k1_img&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inspecting-the-metadata">
<h2>🔍 Inspecting the Metadata<a class="headerlink" href="#inspecting-the-metadata" title="Permalink to this headline">¶</a></h2>
<p>When you first open a dataset it is often helpful to get your bearings by inspecting the metadata.  In rasterio we do this by inspecting the DatasetReader object (<code class="docutils literal notranslate"><span class="pre">src</span></code>) that was returned when you opened the object.</p>
<p>There are <a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#rasterio._base.DatasetBase">lots of attributes</a> that you check a dataset reader for.  If you want to get an general overview I like to use <code class="docutils literal notranslate"><span class="pre">src.meta</span></code>.  To extract specific values here are some more attributes that I find useful:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id1"><code class="docutils literal notranslate"><span class="pre">src.bounds</span></code></a> - Returns the lower left and upper right bounds of the dataset in the units of its coordinate reference system. (lower left x, lower left y, upper right x, upper right y)</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id5"><code class="docutils literal notranslate"><span class="pre">src.count</span></code></a> - The number of raster bands in the dataset</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id6"><code class="docutils literal notranslate"><span class="pre">src.crs</span></code></a> - The dataset’s coordinate reference system</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id7"><code class="docutils literal notranslate"><span class="pre">src.descriptions</span></code></a> - Descriptions for each dataset band</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#rasterio._base.DatasetBase.dtypes"><code class="docutils literal notranslate"><span class="pre">src.dtypes</span></code></a> - The data types of each band in index order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src.height</span></code> - The number of pixels in each column</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id11"><code class="docutils literal notranslate"><span class="pre">src.indexes</span></code></a> - The 1-based indexes of each band in the dataset</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id14"><code class="docutils literal notranslate"><span class="pre">src.meta</span></code></a> - The basic metadata of this dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src.name</span></code> - Relative filepath of the dataset</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id17"><code class="docutils literal notranslate"><span class="pre">src.nodata</span></code></a> - The dataset’s single nodata value</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id22"><code class="docutils literal notranslate"><span class="pre">src.res</span></code></a> - Returns the (width, height) of pixels in the units of its coordinate reference system.</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id24"><code class="docutils literal notranslate"><span class="pre">src.transform</span></code></a> - The dataset’s georeferencing transformation matrix</p></li>
<li><p><a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio._base.html#id25"><code class="docutils literal notranslate"><span class="pre">src.units</span></code></a> - one units string for each dataset band</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src.width</span></code> - the number of pixels in each row</p></li>
</ul>
<p>All of the parts of the raster that were addressed in the first section of this notebook  <em>Anatomy of a raster</em> are accessible using these attributes.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try substituting any of the above attributes in for this dataset</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;driver&#39;: &#39;ENVI&#39;, &#39;dtype&#39;: &#39;float32&#39;, &#39;nodata&#39;: None, &#39;width&#39;: 375, &#39;height&#39;: 250, &#39;count&#39;: 224, &#39;crs&#39;: CRS.from_epsg(32610), &#39;transform&#39;: Affine(1.02258007728804e-15, 16.7, 769855.79,
       16.7, -1.02258007728804e-15, 3751257.6)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(224, 250, 375)
</pre></div>
</div>
</div>
</div>
<p>With the above print statement we learned from the <code class="docutils literal notranslate"><span class="pre">src.meta</span></code> information that the raster has 224 bands (<code class="docutils literal notranslate"><span class="pre">count</span></code>) it has the coordinate reference system EPSG code 32610 (<code class="docutils literal notranslate"><span class="pre">crs</span></code>), it is an ENVI filetype (<code class="docutils literal notranslate"><span class="pre">driver</span></code>), the datatype is float32 (<code class="docutils literal notranslate"><span class="pre">dtype</span></code>), it has 250 rows or is 250 pixels tall (<code class="docutils literal notranslate"><span class="pre">height</span></code>), there isn’t a nodata value set (<code class="docutils literal notranslate"><span class="pre">nodata</span></code>), the affine tranform is (1.02258007728804e-15, 16.7, 769855.79, 16.7, -1.02258007728804e-15, 3751257.6) (<code class="docutils literal notranslate"><span class="pre">tranform</span></code>), and that the raster has 375 columns or is 375 pixels wide.  We also see the relative filepath of the raster from the <code class="docutils literal notranslate"><span class="pre">src.name</span></code> attribute.</p>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>Which of the following are metadata in an AVIRIS reflectance dataset?</p>
<ul class="simple">
<li><p>A) Number of bands</p></li>
<li><p>B) Coordinate information</p></li>
<li><p>C) Reflectance values</p></li>
<li><p>D) Height/Lines and Width/Samples</p></li>
</ul>
<p>Answer with all of the letters that are metadata.</p>
</div>
</div>
</div>
<div class="section" id="working-with-the-data">
<h2>🚜 Working with the Data<a class="headerlink" href="#working-with-the-data" title="Permalink to this headline">¶</a></h2>
<p>While the raster file is is accessed through a unique filetype-specific library, the actual data is almost always just a common matrix datatype.  Numpy is the most common library used, but xarray is also used by some data libraries.</p>
<p>This means that everything we working on last week for matricies applies to the data inside the raster file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">red_band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">blue_band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">green_band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="indexing">
<h3>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h3>
<p>A reminder about matrix indexing:</p>
<ul class="simple">
<li><p>2D matrices use row, column order</p></li>
<li><p>3D matrices use height, row, column order</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span><span class="p">[</span><span class="mi">249</span><span class="p">,</span> <span class="mi">374</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.005221703
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span><span class="p">[</span><span class="mi">144</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0062336302
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># One long row of data</span>
<span class="n">red_band</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
       -9.89863992e-01, -9.89863992e-01, -9.89863992e-01, -9.89863992e-01,
        9.60341003e-03,  8.56745243e-03,  9.77658853e-03,  1.21959150e-02,
        1.21608926e-02,  1.01511301e-02,  1.22256568e-02,  1.22256568e-02,
        9.97462496e-03,  1.32317590e-02,  9.90260020e-03,  7.78485741e-03,
        1.16055440e-02,  1.03626624e-02,  1.03626624e-02,  8.48274026e-03,
        1.07032945e-02,  1.05163530e-02,  5.99020347e-03,  9.29890200e-03,
        1.20315310e-02,  8.23581219e-03,  8.52218829e-03,  8.52218829e-03,
        9.99249145e-03,  1.08621847e-02,  1.27621852e-02,  9.74960625e-03,
        9.93011892e-03,  1.10991010e-02,  9.72998329e-03,  9.72998329e-03,
        1.37429517e-02,  1.07355947e-02,  1.04636298e-02,  1.22513892e-02,
        1.17190378e-02,  9.16020479e-03,  1.16725871e-02,  1.16725871e-02,
        9.93436389e-03,  9.92709771e-03,  7.87495449e-03,  9.22061317e-03,
        1.08120767e-02,  1.17061716e-02,  7.62484455e-03,  7.62484455e-03,
        1.27769317e-02,  1.16161704e-02,  1.13528278e-02,  9.19037219e-03,
        1.14430059e-02,  1.06365317e-02,  7.00194389e-03,  9.92375892e-03,
        1.04948664e-02,  1.04948664e-02,  9.83347651e-03,  4.01473558e-03,
        1.02585070e-02,  6.51265541e-03,  3.85753764e-03,  1.37749342e-02,
        1.18129533e-02,  1.18129533e-02,  1.16536515e-02,  8.72882642e-03,
        1.08521413e-02,  1.13936057e-02,  1.24934735e-02,  1.01565169e-02,
        7.94219784e-03,  1.11402711e-02,  1.11402711e-02,  1.07124457e-02,
        9.70683526e-03,  9.39665642e-03,  1.11531522e-02,  1.22633809e-02,
        1.00097349e-02,  1.03047434e-02,  1.22710364e-02,  7.45117245e-03,
        8.91800411e-03,  8.91800411e-03,  1.00032743e-02,  1.03893792e-02,
        1.14607411e-02,  1.13273570e-02,  9.52258985e-03,  1.04254112e-02,
        9.68714152e-03,  7.56124547e-03,  7.56124547e-03,  9.12059192e-03,
        1.15978923e-02,  8.94551259e-03,  9.03818756e-03,  1.14348466e-02,
        1.12770488e-02,  1.01099340e-02,  1.09425560e-02,  1.27936015e-02,
        1.03212325e-02,  1.20040122e-02,  1.15839001e-02,  1.09657971e-02,
        1.08133005e-02,  1.14410305e-02,  1.02785453e-02,  1.22435279e-02,
        1.13794953e-02,  1.03773763e-02,  1.46823423e-02,  1.31757027e-02,
        1.31757027e-02,  1.34336296e-02,  1.34091042e-02,  1.01813180e-02,
        7.18480861e-03,  1.32976491e-02,  9.29967128e-03,  9.34869051e-03,
        8.52198992e-03,  8.50201119e-03,  8.50201119e-03,  1.13882786e-02,
        8.57987348e-03,  8.28727987e-03,  1.09522119e-02,  8.20450671e-03,
        1.02974121e-02,  9.24416911e-03,  1.05280252e-02,  9.57950391e-03,
        9.75759793e-03,  9.37086716e-03,  9.37086716e-03,  8.56183190e-03,
        9.64759290e-03,  1.14238849e-02,  7.76233617e-03,  7.44129391e-03,
        5.89989871e-03,  6.99818227e-03,  8.07397719e-03,  7.37830950e-03,
        5.37360925e-03,  7.98865873e-03,  7.98865873e-03,  5.78207243e-03,
        3.37526924e-03,  1.02493092e-02,  8.17018934e-03,  5.70513587e-03,
        9.31401737e-03,  5.99309057e-03,  1.04032306e-03,  2.40463717e-03,
        7.23264366e-03,  6.07277872e-03,  7.87939131e-03,  7.87939131e-03,
        5.02707716e-03,  1.04341060e-02,  6.54117577e-03,  6.40173163e-03,
        8.48427694e-03,  9.44371521e-03,  1.09653706e-02,  8.80982541e-03,
        8.23528913e-04,  5.77815436e-03,  1.14251103e-03,  1.14251103e-03,
        5.72341774e-03,  7.61449104e-03,  5.68367587e-03,  1.26515748e-02,
        5.33479173e-03,  6.80172350e-03,  8.36720411e-03,  7.88195804e-03,
        1.25120173e-03,  1.03334403e-02,  9.92541667e-03,  1.33938612e-02,
        1.33938612e-02,  7.69980485e-03,  9.40576103e-03,  5.77459997e-03,
        6.79657003e-03,  1.15214370e-03,  4.47639171e-03,  1.15755051e-02,
        8.78010783e-03,  8.72862712e-03,  9.10193846e-03,  5.86174522e-03,
        6.20170590e-03,  5.15950611e-03,  4.94923256e-03,  4.94923256e-03,
        7.73387915e-03,  6.25468977e-03,  7.82719348e-03,  6.18605362e-03,
        5.79997199e-03,  8.95670056e-03,  8.15831777e-03,  1.17874248e-02,
        5.76946558e-03,  7.13090133e-03,  4.88395710e-03,  2.29153968e-03,
        7.00125797e-03,  5.55184297e-03,  5.44924103e-03,  5.44924103e-03,
        5.80242230e-03,  8.49946123e-03,  7.27876043e-03,  9.87273734e-03,
        6.17004791e-03,  4.39421041e-03,  3.98266455e-03,  6.80908607e-03,
        8.64381902e-03,  7.45708495e-03,  5.65337949e-03,  7.08853174e-03,
        9.51331947e-03,  9.51331947e-03,  1.79716554e-02,  6.48755431e-02,
        1.11067332e-01,  3.25312838e-02,  1.32159684e-02,  1.57204792e-02,
        1.82487592e-02,  2.96701975e-02,  9.13888589e-02,  1.68310538e-01,
        2.26290867e-01,  1.68618903e-01,  1.52089566e-01,  1.53015971e-01,
        1.71361595e-01,  1.71361595e-01,  1.78749010e-01,  1.68540463e-01,
        1.47794291e-01,  1.26275867e-01,  1.13734059e-01,  1.01421140e-01,
        8.83982405e-02,  9.72591266e-02,  1.32041112e-01,  1.59027189e-01,
        1.94381401e-01,  2.22682908e-01,  2.15925947e-01,  2.15925947e-01,
        2.29753554e-01,  2.33850136e-01,  2.35325441e-01,  2.55388141e-01,
        2.82413244e-01,  3.10377479e-01,  3.28700691e-01,  2.59206623e-01,
        2.51021773e-01,  2.54293412e-01,  2.89322555e-01,  3.31567198e-01,
        3.36291105e-01,  3.10564101e-01,  3.10564101e-01,  2.74938077e-01,
        2.63735503e-01,  2.59882569e-01,  2.79308110e-01,  2.56433010e-01,
        2.47580290e-01,  2.55837888e-01,  2.67711788e-01,  2.15465501e-01,
        1.56197593e-01,  1.37191728e-01,  1.23051502e-01,  1.19016066e-01,
        1.14996009e-01,  1.30868509e-01,  1.41310662e-01,  1.41310662e-01,
        1.36986896e-01,  1.45302624e-01,  1.62975192e-01,  1.80153936e-01,
        2.03104600e-01,  1.95680529e-01,  2.11470127e-01,  2.07485899e-01,
        1.85355276e-01,  1.83796972e-01,  1.77590415e-01,  1.59322709e-01,
        1.48297369e-01,  1.56327918e-01,  1.51601136e-01,  1.51601136e-01,
        1.54474974e-01,  1.83645815e-01,  2.62981385e-01,  2.58784413e-01,
        1.68838456e-01,  1.10366546e-01,  9.83937159e-02,  8.98709968e-02,
        7.62339979e-02,  1.12549394e-01,  1.21540807e-01,  1.02702200e-01,
        1.04190111e-01,  1.32186681e-01,  1.56810403e-01,  1.60454646e-01,
        1.45415485e-01,  1.29735738e-01,  1.34829611e-01,  1.46270335e-01,
        1.47036850e-01,  1.60749197e-01,  1.60749197e-01,  1.77667767e-01,
        1.45186886e-01,  1.20232992e-01,  1.24302126e-01,  1.59918860e-01,
        1.74745366e-01,  1.62464723e-01,  9.29672793e-02], dtype=float32)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exploratory-statistics">
<h3>Exploratory statistics<a class="headerlink" href="#exploratory-statistics" title="Permalink to this headline">¶</a></h3>
<p>When I open a dataset I often like to get a sense of it by just looking at looking at statistics for one of the bands.  We can use the aggregation functions from last week for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max value: &#39;</span><span class="p">,</span> <span class="n">green_band</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean value: &#39;</span><span class="p">,</span> <span class="n">green_band</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;min value: &#39;</span><span class="p">,</span> <span class="n">green_band</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>max value:  0.4638913
mean value:  -0.037566137
min value:  -0.9919098
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="matrix-operations">
<h3>Matrix Operations<a class="headerlink" href="#matrix-operations" title="Permalink to this headline">¶</a></h3>
<p>Adding and subtracting two matrices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span> <span class="o">+</span> <span class="n">green_band</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.9817739 , -1.9817739 , -1.9817739 , ...,  0.13850516,
         0.20546283,  0.33700895],
       [-1.9817739 , -1.9817739 , -1.9817739 , ...,  0.18310083,
         0.27180833,  0.28681755],
       [-1.9817739 , -1.9817739 , -1.9817739 , ...,  0.28129148,
         0.29883683,  0.23306896],
       ...,
       [-1.9817739 , -1.9817739 , -1.9817739 , ...,  0.04379314,
         0.04434666,  0.04983609],
       [-1.9817739 , -1.9817739 , -1.9817739 , ...,  0.04094062,
         0.05011846,  0.04768296],
       [-1.9817739 , -1.9817739 , -1.9817739 , ...,  0.05058881,
         0.04569351,  0.04583649]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blue_band</span> <span class="o">-</span> <span class="n">red_band</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.03121787,  0.03121787,  0.03121787, ..., -0.06602393,
        -0.11272857, -0.20093265],
       [ 0.03121787,  0.03121787,  0.03121787, ..., -0.0920296 ,
        -0.15151955, -0.14239667],
       [ 0.03121787,  0.03121787,  0.03121787, ..., -0.15002072,
        -0.17034033, -0.11561722],
       ...,
       [ 0.03121787,  0.03121787,  0.03121787, ...,  0.04716351,
         0.04572179,  0.05058041],
       [ 0.03121787,  0.03121787,  0.03121787, ...,  0.05341611,
         0.05365299,  0.05151878],
       [ 0.03121787,  0.03121787,  0.03121787, ...,  0.05188685,
         0.05395792,  0.0552441 ]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>Multiplying or dividing a matrix by a constant</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red_band</span><span class="o">*</span><span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.94932   , -4.94932   , -4.94932   , ...,  0.4822076 ,
         0.768427  ,  1.2765377 ],
       [-4.94932   , -4.94932   , -4.94932   , ...,  0.6515627 ,
         1.0018888 ,  1.0037379 ],
       [-4.94932   , -4.94932   , -4.94932   , ...,  1.0025584 ,
         1.0973514 ,  0.81842124],
       ...,
       [-4.94932   , -4.94932   , -4.94932   , ...,  0.02871939,
         0.03346157,  0.04347686],
       [-4.94932   , -4.94932   , -4.94932   , ...,  0.01182676,
         0.04153725,  0.03549127],
       [-4.94932   , -4.94932   , -4.94932   , ...,  0.05110819,
         0.02780656,  0.02610851]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">green_band</span><span class="o">/</span><span class="mi">7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.1417014 , -0.1417014 , -0.1417014 , ...,  0.00600909,
         0.00739677,  0.01167163],
       [-0.1417014 , -0.1417014 , -0.1417014 , ...,  0.00754119,
         0.01020437,  0.01229571],
       [-0.1417014 , -0.1417014 , -0.1417014 , ...,  0.01153998,
         0.01133808,  0.0099121 ],
       ...,
       [-0.1417014 , -0.1417014 , -0.1417014 , ...,  0.00543561,
         0.00537919,  0.00587725],
       [-0.1417014 , -0.1417014 , -0.1417014 , ...,  0.00551075,
         0.005973  ,  0.00579782],
       [-0.1417014 , -0.1417014 , -0.1417014 , ...,  0.00576674,
         0.00573317,  0.00580211]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>Some other built in operations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We have to take the absolute value of red because the nodata values are negative </span>
<span class="c1"># and that throws an error</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">red_band</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.99491906, 0.99491906, 0.99491906, ..., 0.31055036, 0.3920273 ,
        0.50527966],
       [0.99491906, 0.99491906, 0.99491906, ..., 0.36098826, 0.44763574,
        0.44804865],
       [0.99491906, 0.99491906, 0.99491906, ..., 0.4477853 , 0.46847656,
        0.4045791 ],
       ...,
       [0.99491906, 0.99491906, 0.99491906, ..., 0.07578838, 0.08180656,
        0.09324898],
       [0.99491906, 0.99491906, 0.99491906, ..., 0.04863489, 0.09114521,
        0.08425114],
       [0.99491906, 0.99491906, 0.99491906, ..., 0.10110211, 0.07457421,
        0.07226136]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">red_band</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-9.50336993e-01, -9.50336993e-01, -9.50336993e-01, ...,
         8.34296225e-06,  8.57359846e-05,  1.08472107e-03],
       [-9.50336993e-01, -9.50336993e-01, -9.50336993e-01, ...,
         3.75777636e-05,  3.23033426e-04,  3.26025620e-04],
       [-9.50336993e-01, -9.50336993e-01, -9.50336993e-01, ...,
         3.24114313e-04,  5.09188452e-04,  1.17499076e-04],
       ...,
       [-9.50336993e-01, -9.50336993e-01, -9.50336993e-01, ...,
         6.25210387e-12,  1.34239833e-11,  4.97096496e-11],
       [-9.50336993e-01, -9.50336993e-01, -9.50336993e-01, ...,
         7.40421450e-14,  3.95674951e-11,  1.80201236e-11],
       [-9.50336993e-01, -9.50336993e-01, -9.50336993e-01, ...,
         1.11584131e-10,  5.31969304e-12,  3.88204789e-12]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>There are lots more built in functions.  <a class="reference external" href="https://www.oreilly.com/library/view/python-for-data/9781449323592/ch04.html#table_unary_ufuncs">This table</a> has a nice list.</p>
</div>
<div class="section" id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h3>
<p>Also notice that plotting works for a single band</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">red_band</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x119394580&gt;
</pre></div>
</div>
<img alt="../../_images/2_raster_fundamentals_62_1.png" src="../../_images/2_raster_fundamentals_62_1.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">📝 Check your understanding</p>
<p>Say that the variable <code class="docutils literal notranslate"><span class="pre">reflectance</span></code> hold all of the data for an AVIRIS raster – count 224 with 1000 rows and 350 columns.</p>
<p>What is the index you need to use to get the all the data for band 100?</p>
</div>
</div>
</div>
<div class="section" id="saving-a-file">
<h2>💾 Saving a file<a class="headerlink" href="#saving-a-file" title="Permalink to this headline">¶</a></h2>
<p>At a certain point you may want to do it.  Let’s start by getting some data to save</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get our data setup</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath_rad</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">red_src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">blue_src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">green_src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>It is best practice to persist or update as much of the metadata from your old raster as you can.  As you may have experienced working with data, complete and accurate metadata can make someone else’s life (and maybe even your own) much easier down the road.  Make sure you look at it, though, to make sure all the information still applies to your new raster.</p>
<p>Count has changed, since we are only saving 3 of the 224 total bands, so we need to upadate the <code class="docutils literal notranslate"><span class="pre">count</span></code> value.  I am also going to set -50 as the nodata value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<p>Another thing you could do is add tags to your bands so that you remember what band number you used.  You do this when you write out the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the output directory if it does not exist yet</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;../output_data&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;../output_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
    <span class="s1">&#39;../output_data/rgb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;w&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">meta</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="c1"># Write data matrices</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">red_src</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">green_src</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">blue_src</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1"># Add band tags</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">src_band</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">src_band</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">src_band</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we want to confirm that our dataset saved properly we can open it back up and look at what we saved.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../output_data/rgb&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">red_dst</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">green_dst</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">blue_dst</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Source stats: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;red: &#39;</span><span class="p">,</span> <span class="n">red_src</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">red_src</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;green: &#39;</span><span class="p">,</span> <span class="n">green_src</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">green_src</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blue: &#39;</span><span class="p">,</span> <span class="n">blue_src</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">blue_src</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Destination stats: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;red: &#39;</span><span class="p">,</span> <span class="n">red_dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">red_dst</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;green: &#39;</span><span class="p">,</span> <span class="n">green_dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">green_dst</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blue: &#39;</span><span class="p">,</span> <span class="n">blue_dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">blue_dst</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Source stats: 
red:  -0.043670043 0.40461412
green:  -0.022554584 0.41501164
blue:  -0.037566137 0.4638913
Destination stats: 
red:  -0.043670043 0.40461412
green:  -0.022554584 0.41501164
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blue:  -0.037566137 0.4638913
</pre></div>
</div>
</div>
</div>
<p>Our values line up!  And the new values came from the raster we made ourselves.  😄</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons/raster_data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="1_arrays_numpy.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Arrays and <code class="docutils literal notranslate"><span class="pre">numpy</span></code></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3_accessing_coordinates.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Accessing Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Rachel Wegener<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>